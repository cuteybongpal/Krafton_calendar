<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>달력 + 사이드바</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f4f4f4;
    }
    .sidebar {
      background-color: #fff;
      min-height: 100vh;
      padding: 20px;
      box-shadow: 2px 0 6px rgba(0,0,0,0.1);
    }
    .widget {
      background: #f9f9f9;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
    }
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: .2rem;
    }
    .calendar-cell {
      height: 120px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      border-radius: .5rem;
      font-size: .75rem;
      cursor: pointer;
      padding: 2px;
      position: relative;
    }
    .calendar-cell.disabled { color: #bbb; cursor: not-allowed; }
    .calendar-cell.today { border: 1px solid #0d6efd; }
    .calendar-cell.selected { background-color: #0d6efd; color: white; }
    .calendar-event {
      font-size: .65rem;
      color: #0d6efd;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      width: 100%;
    }
    .weekday {
      font-weight: 600;
      text-align: center;
      font-size: .75rem;
      padding: .1rem 0;
    }
  </style>
</head>
<body>

<div class="container-fluid">
  <div class="row">
    
    <!-- 왼쪽 사이드바 -->
    <div class="col-3 sidebar">
        
      <div class="widget">
        <h5>오늘 날짜</h5>
        <h4 id="today-date"></h4>
      </div>
      <div class="widget">
        <h5>오늘 급식</h5>
        <p>
          A : 된장찌개, 야채볶음밥<br>
          B : 김치찌개, 비빔밥
        </p>
      </div>
      <div class="widget">
        <button class="btn btn-success w-100">로그아웃</button>
      </div>
    </div>

    <!-- 오른쪽 달력 -->
    <div class="col-9 p-4">
      <div class="card shadow-sm">
        <div class="card-body">

          <!-- 달력 헤더 -->
          <div class="d-flex justify-content-between align-items-center mb-3">
            <button class="btn btn-outline-secondary btn-sm" id="prevBtn">&lt;</button>
            <h5 class="mb-0" id="monthLabel"></h5>
            <button class="btn btn-outline-secondary btn-sm" id="nextBtn">&gt;</button>
          </div>

          <!-- 요일 헤더 -->
          <div class="calendar-grid text-muted mb-1">
            <div class="weekday">월</div>
            <div class="weekday">화</div>
            <div class="weekday">수</div>
            <div class="weekday">목</div>
            <div class="weekday">금</div>
            <div class="weekday text-danger">토</div>
            <div class="weekday text-danger">일</div>
          </div>

          <!-- 날짜 그리드 -->
          <div id="calendarGrid" class="calendar-grid"></div>
        </div>
      </div>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // 오늘 날짜
  document.getElementById("today-date").innerText = new Date().toISOString().split('T')[0];

  const MIN_DATE = new Date(2025, 8, 1);
  const MAX_DATE = new Date(2026, 0, 31);
  let current = new Date(2025, 8, 1);
  let selected = null;

  const events = {
    "2025-09-05": "팀 프로젝트 회의",
    "2025-09-12": "병원 예약 오후 2시",
    "2025-10-03": "개천절 휴일",
    "2025-11-20": "친구 생일 파티",
    "2026-01-01": "신정 연휴"
  };

  const monthLabel = document.getElementById("monthLabel");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");
  const grid = document.getElementById("calendarGrid");

  function formatDateKey(date) {
    return date.toISOString().split("T")[0];
  }

  function renderCalendar() {
    monthLabel.textContent = `${current.getFullYear()}년 ${current.getMonth()+1}월`;

    prevBtn.disabled = new Date(current.getFullYear(), current.getMonth(), 1) <= MIN_DATE;
    nextBtn.disabled = new Date(current.getFullYear(), current.getMonth()+1, 0) >= MAX_DATE;

    grid.innerHTML = "";
    const startDay = new Date(current.getFullYear(), current.getMonth(), 1);
    const endDay = new Date(current.getFullYear(), current.getMonth()+1, 0);
    const startWeekDay = (startDay.getDay() + 6) % 7; // 월요일 시작

    let days = [];
    for (let i=0; i<startWeekDay; i++) days.push(null);
    for (let d=1; d<=endDay.getDate(); d++) {
      days.push(new Date(current.getFullYear(), current.getMonth(), d));
    }

    days.forEach(date => {
      const cell = document.createElement("div");
      cell.className = "calendar-cell border";

      if (date) {
        const key = formatDateKey(date);

        const dateDiv = document.createElement("div");
        dateDiv.textContent = date.getDate();
        cell.appendChild(dateDiv);

        const today = new Date();
        if (date.toDateString() === today.toDateString()) cell.classList.add("today");
        if (selected && date.toDateString() === selected.toDateString()) cell.classList.add("selected");
        if (date < MIN_DATE || date > MAX_DATE) {
          cell.classList.add("disabled");
        } else {
          cell.addEventListener("click", () => {
            selected = date;
            renderCalendar();
          });
        }

        if (events[key]) {
          const eventDiv = document.createElement("div");
          eventDiv.className = "calendar-event";
          eventDiv.textContent = events[key];
          eventDiv.setAttribute("data-bs-toggle", "tooltip");
          eventDiv.setAttribute("title", events[key]);
          cell.appendChild(eventDiv);
        }
      }
      grid.appendChild(cell);
    });

    // 툴팁 초기화
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(el => new bootstrap.Tooltip(el));
  }

  prevBtn.addEventListener("click", () => {
    current.setMonth(current.getMonth() - 1);
    renderCalendar();
  });
  nextBtn.addEventListener("click", () => {
    current.setMonth(current.getMonth() + 1);
    renderCalendar();
  });

  renderCalendar();
</script>

</body>
</html>
